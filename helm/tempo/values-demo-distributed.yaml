# Tempo - Distributed chart in monolithic mode for demo
# Uses grafana/tempo-distributed chart (non-deprecated) in single-binary mode

global:
  clusterDomain: cluster.local

tempo:
  storage:
    trace:
      backend: s3
      s3:
        bucket: odontoagil-obs-tempo
        endpoint: s3.us-east-1.amazonaws.com
        region: us-east-1
        insecure: false

  receivers:
    otlp:
      protocols:
        grpc:
          endpoint: 0.0.0.0:4317
        http:
          endpoint: 0.0.0.0:4318

  metricsGenerator:
    enabled: false  # Disable for demo to reduce resource usage

# Use scalable monolithic deployment mode (single binary, can scale horizontally)
deploymentMode: SingleBinary

serviceAccount:
  create: true
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::699475921438:role/obs-lgtm-demo-tempo-s3-access

# Single replica for demo
singleBinary:
  replicas: 1
  resources:
    requests:
      cpu: "100m"
      memory: "256Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"
  persistence:
    enabled: true
    size: 5Gi
    storageClass: gp3

# Gateway for unified ingress
gateway:
  enabled: true
  replicas: 1
  resources:
    requests:
      cpu: "50m"
      memory: "64Mi"
    limits:
      cpu: "100m"
      memory: "128Mi"

# Disable distributed components (we're using monolithic mode)
ingester:
  replicas: 0
distributor:
  replicas: 0
querier:
  replicas: 0
queryFrontend:
  replicas: 0
compactor:
  replicas: 0
metrics_generator:
  enabled: false
