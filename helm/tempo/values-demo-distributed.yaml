# Tempo demo overrides â€” minimal distributed mode
# Uses grafana/tempo-distributed chart with 1 replica per component

tempo:
  storage:
    trace:
      backend: s3
      s3:
        bucket: obs-platform-tempo
        endpoint: s3.us-east-1.amazonaws.com
        region: us-east-1
        insecure: false

# Enable OTLP receivers on the distributor
traces:
  otlp:
    grpc:
      enabled: true
    http:
      enabled: true

serviceAccount:
  create: true
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::699475921438:role/obs-lgtm-demo-tempo-s3-access

ingester:
  replicas: 1
  config:
    replication_factor: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 250m
      memory: 512Mi
  persistence:
    enabled: true
    size: 5Gi
    storageClass: gp3
  topologySpreadConstraints: []

distributor:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 250m
      memory: 512Mi

compactor:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 250m
      memory: 512Mi

querier:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 250m
      memory: 512Mi

queryFrontend:
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 250m
      memory: 256Mi

metricsGenerator:
  enabled: true
  replicas: 1
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
  config:
    storage:
      remote_write:
        - url: http://mimir-distributor.observability.svc:8080/api/v1/push
          headers:
            X-Scope-OrgID: anonymous

gateway:
  enabled: true
  replicas: 1
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

# Enable metrics generator processors (span-metrics produce RED metrics for alerts)
overrides:
  defaults:
    metrics_generator:
      processors:
        - service-graphs
        - span-metrics
